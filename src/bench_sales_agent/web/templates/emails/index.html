{% extends "base.html" %}
{% block title %}Emails — Bench Sales Agent{% endblock %}
{% block content %}
<h2 class="text-2xl font-bold mb-6">Email & Hotlist Generation</h2>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <!-- Hotlist -->
    <div class="bg-dark-800 rounded-lg p-5 border border-dark-600">
        <h3 class="text-lg font-semibold mb-3">Generate Hotlist Email</h3>
        <p class="text-sm text-gray-400 mb-4">Creates a hotlist email with all consultants on bench.</p>
        <form hx-post="/emails/hotlist" hx-target="#email-preview" hx-indicator="#email-spinner">
            <button type="submit" class="px-4 py-2 bg-accent text-dark-900 rounded font-semibold text-sm hover:bg-accent-light">Generate Hotlist</button>
        </form>
    </div>

    <!-- Submission email -->
    <div class="bg-dark-800 rounded-lg p-5 border border-dark-600">
        <h3 class="text-lg font-semibold mb-3">Submission Email</h3>
        <form hx-post="/emails/submission" hx-target="#email-preview" hx-indicator="#email-spinner" class="space-y-3">
            <div>
                <label class="block text-sm text-gray-400 mb-1">Consultant</label>
                <select name="consultant_id" required class="w-full px-3 py-2 bg-dark-900 border border-dark-600 rounded text-gray-200 text-sm">
                    <option value="">— Select —</option>
                    {% for c in consultants %}
                    <option value="{{ c.id }}">{{ c.full_name }} — {{ c.job_title }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label class="block text-sm text-gray-400 mb-1">Job Requirement</label>
                <select name="job_id" required class="w-full px-3 py-2 bg-dark-900 border border-dark-600 rounded text-gray-200 text-sm">
                    <option value="">— Select —</option>
                    {% for j in jobs %}
                    <option value="{{ j.id }}">{{ j.title }} @ {{ j.vendor_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="flex gap-2">
                <button type="submit" class="px-4 py-2 bg-accent text-dark-900 rounded font-semibold text-sm hover:bg-accent-light">Generate</button>
                <button type="submit" formaction="/emails/ai-submission" class="px-4 py-2 bg-purple-700 rounded font-semibold text-sm hover:bg-purple-600">AI-Craft</button>
            </div>
        </form>
    </div>
</div>

<span id="email-spinner" class="htmx-indicator text-sm text-gray-400 mb-2 block">
    <svg class="inline spinner w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" stroke-dasharray="60" stroke-dashoffset="20"/></svg>
    Generating...
</span>
<div id="email-preview"></div>
{% endblock %}
