{% extends "base.html" %}
{% block title %}{{ c.full_name }} — Bench Sales Agent{% endblock %}
{% block content %}
<div class="flex items-center justify-between mb-6">
    <div>
        <h2 class="text-2xl font-bold">{{ c.full_name }}</h2>
        <p class="text-gray-400">{{ c.job_title }} | {{ c.visa_status.value }} | {{ c.current_location or 'No location' }}</p>
    </div>
    <div class="flex gap-2">
        <a href="/search?consultant_id={{ c.id }}" class="px-4 py-2 bg-green-700 rounded text-sm font-semibold hover:bg-green-600">Search Roles</a>
        <form method="post" action="/consultants/{{ c.id }}/delete" onsubmit="return confirm('Delete this consultant?')">
            <button type="submit" class="px-4 py-2 bg-red-800 rounded text-sm hover:bg-red-700">Delete</button>
        </form>
    </div>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div class="bg-dark-800 rounded-lg p-5 border border-dark-600">
        <h3 class="text-lg font-semibold mb-3">Profile</h3>
        <table class="w-full text-sm">
            <tr class="border-b border-dark-700"><td class="py-2 text-gray-400 w-40">Email</td><td>{{ c.email or '—' }}</td></tr>
            <tr class="border-b border-dark-700"><td class="py-2 text-gray-400">Phone</td><td>{{ c.phone or '—' }}</td></tr>
            <tr class="border-b border-dark-700"><td class="py-2 text-gray-400">Experience</td><td>{{ c.total_experience_years }} yrs ({{ c.us_experience_years }} US)</td></tr>
            <tr class="border-b border-dark-700"><td class="py-2 text-gray-400">Remote Pref</td><td>{{ c.remote_preference }}</td></tr>
            <tr class="border-b border-dark-700"><td class="py-2 text-gray-400">Relocation</td><td>{{ 'Yes' if c.relocation else 'No' }}</td></tr>
            <tr class="border-b border-dark-700"><td class="py-2 text-gray-400">Rate</td><td>{{ c.rate_display() }}</td></tr>
            <tr><td class="py-2 text-gray-400">Bench Since</td><td>{{ c.bench_since }} ({{ c.bench_duration_days() }} days)</td></tr>
        </table>
    </div>
    <div class="bg-dark-800 rounded-lg p-5 border border-dark-600">
        <h3 class="text-lg font-semibold mb-3">Skills</h3>
        <div class="mb-3">
            <span class="text-xs text-gray-500 uppercase">Primary</span>
            <div class="flex flex-wrap gap-2 mt-1">
                {% for s in c.primary_skills %}
                <span class="px-2 py-1 bg-accent/20 text-accent rounded text-xs">{{ s }}</span>
                {% endfor %}
            </div>
        </div>
        {% if c.secondary_skills %}
        <div>
            <span class="text-xs text-gray-500 uppercase">Secondary</span>
            <div class="flex flex-wrap gap-2 mt-1">
                {% for s in c.secondary_skills %}
                <span class="px-2 py-1 bg-dark-700 text-gray-300 rounded text-xs">{{ s }}</span>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        <div class="mt-4 pt-3 border-t border-dark-700">
            <span class="text-xs text-gray-500">One-liner:</span>
            <p class="text-sm mt-1">{{ c.one_liner() }}</p>
        </div>
    </div>
</div>

<!-- AI Analysis -->
<div class="bg-dark-800 rounded-lg p-5 border border-dark-600">
    <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg font-semibold">AI Profile Analysis</h3>
        <button
            hx-post="/consultants/{{ c.id }}/analyze"
            hx-target="#analysis-result"
            hx-indicator="#analysis-spinner"
            class="px-4 py-1.5 bg-accent text-dark-900 rounded text-sm font-semibold hover:bg-accent-light">
            Analyze
        </button>
    </div>
    <span id="analysis-spinner" class="htmx-indicator text-sm text-gray-400">
        <svg class="inline spinner w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10" stroke-dasharray="60" stroke-dashoffset="20"/></svg>
        Analyzing with AI...
    </span>
    <div id="analysis-result"></div>
</div>
{% endblock %}
